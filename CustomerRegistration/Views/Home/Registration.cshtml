@model CustomerRegistration.Models.Customer;
@{
    ViewData["Title"] = "Registration";

}


<form>
    <table border="0" align="center">
        <thead>
            <tr align="center">
                <th colspan="2"><h1>REGISTRATION FORM</h1></th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td></td>
                <td>
                    @if (Model.CustomerId != 0)
                    {
                    <input id="txtid" hidden class="form-control " value="@Model.CustomerId" />
                    }
                    
                </td>
            </tr>
            <tr>
                <td>Enter Customer Code:</td>
                <td>
                    @if(!String.IsNullOrWhiteSpace(Model.CustomerCode))
                    {
                        <input id="txtcode" maxlength="15" class="form-control txtCustomerCode" placeholder="Enter Customer Code" value="@Model.CustomerCode" />
                    }
                    else
                    {
                        <input id="txtcode" maxlength="15" class="form-control txtCustomerCode" placeholder="Enter Customer Code" />
                    }

                    <span class="text-danger errCustCode"></span>
                </td>
            </tr>
            <tr>
                <td>Enter Customer Name:</td>
                <td>
                    @if(Model.CustomerName != null)
                    {
                        <input id="txtname" class="form-control txtCustomerName" placeholder="Enter Customer Name" value="@Model.CustomerName" />
                        <span class="text-danger errCustName"></span>
                    }
                    else
                    {
                        <input id="txtname" class="form-control txtCustomerName" placeholder="Enter Customer Name" />
                        <span class="text-danger errCustName"></span>
                    }

                </td>
            </tr>
            <tr>
                <td>Enter Mobile Number:</td>
                <td>
                    @if (Model.CustomerPhone != null)
                    {
                        <input id="txtmobile" class="form-control txtMobileNumber" maxlength="10" placeholder="Enter Mobile Number" value="@Model.CustomerPhone"/>
                    }
                    else
                    {
                        <input id="txtmobile" class="form-control txtMobileNumber" maxlength="10" placeholder="Enter Mobile Number" />
                    }
                    <span class="text-danger errCustMob"></span>
                </td>
            </tr>
            <tr>
                <td>Enter Email:</td>
                <td>
                    @if (Model.CustomerEmail != null)
                    {
                        <input id="txtemail" class="form-control txtCustomerEmail" placeholder="Enter Email" value="@Model.CustomerEmail"/>
                        <span class="text-danger errCustEmail"></span>
                    }
                    else
                    {
                        <input id="txtemail" class="form-control txtCustomerEmail" placeholder="Enter Email" />
                    }
                    <span class="text-danger errCustEmail"></span>
                </td>
            </tr>
            <tr>
                <td>Select State:</td>
                <td>
                    @if (Model.StateId != null)
                    {
                    <select asp="StateId" id="StateId" asp-items="@(new SelectList( ViewBag.State,"StateId","StateName"))" class="form-control ddlState"><option value="@Model.StateId">@Model.StateName</option></select>
                    }
                    else
                    {
                        <select asp="StateId" id="StateId" asp-items="@(new SelectList( ViewBag.State,"StateId","StateName"))" class="form-control ddlState">
                        </select>

                    }

                    <span class="text-danger errState"></span>
                </td>
            </tr>
            <tr>
                <td>Select District:</td>
                <td>
                    @if (Model.DistrictId != null)
                    {
                    <select asp="distid" id="distid" class="form-control ddlDistrict" value="@Model.DistrictId">
                        <option value="@Model.DistrictId">@Model.DistrictName</option>
                    </select>
                    }
                    else
                    {
                        <select asp="distid" id="distid" class="form-control ddlDistrict">
                        </select>
                    }

                    <span class="text-danger errDistrict"></span>
                </td>
            </tr>
            <tr>
                <td>Enter City:</td>
                <td>
                    @if (Model.City != null)
                    {
                        <input id="txtcity" class="form-control txtCustCity" placeholder="Enter City Name" value="@Model.City" />
                    }
                    else
                    {
                     <input id="txtcity" class="form-control txtCustCity" placeholder="Enter City Name" />
                    }
                    <span class="text-danger errCustCity"></span>
                </td>
            </tr>
            <tr>
                <td>Enter Pincode:</td>
                <td>
                    @if (Model.Pincode != null)
                     {
                    <input id="txtpincode" class="form-control txtCustPin" placeholder="Enter Pin Code" value="@Model.Pincode"/>
                    }
                    else
                    {
                    <input id="txtpincode" class="form-control txtCustPin" placeholder="Enter Pin Code" />
                    }
                    <span class="text-danger errCustPin"></span>
                </td>
            </tr>
            <tr>
                <td>Select Gender:</td>
                <td>
                    @if (Model.CustomerGender != null)
                    {
                        <input type="radio" id="custgen" name="custgen" class="s_type" value="Male" checked />
                        <label for="custgen">Male</label>
                        <input type="radio" id="custgen" name="custgen" class="s_type" value="Female" />
                        <label for="custgen">Female</label>
                    }
                    else
                    {
                    <input type="radio" id="custgen" name="custgen" class="s_type" value="Male" checked />
                    <label for="custgen">Male</label>
                    <input type="radio" id="custgen" name="custgen" class="s_type" value="Female" />
                    <label for="custgen">Female</label>
                    }

                </td>
            </tr>
            <tr>
                <td>Enter Address:</td>
                <td>
                    @if (Model.CustomerAddress != null)
                    {
                    <textarea id="txtadd">@Model.CustomerAddress</textarea>
                    }
                    else
                    {
                        <textarea id="txtadd"></textarea>
                    }
                    <span class="text-danger errCustAdd"></span>
                </td>
            </tr>
            <tr>
                <td align="center">
                    <input type="button" id="Save" value="Save" class="btn btn-primary btnSaveUpdate " onclick="return Validation()" />
                </td>
                <td align="center">
                </td>
            </tr>
        </tbody>
    </table>
</form>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script type="text/javascript">

    $('.ddlState').change(function (e) {
        var StateId = $('.ddlState option:selected').val();
        if (StateId != 0) {
            $('.errState').text();
            return true;
        }
        else {
            $('.errState').text('Please Select State');
            return false;
        }
    });
    $('.ddlDistrict').change(function (e) {
        var Distid = $('.ddlDistrict option:selected').val();
        if (Distid != 0) {
            $('.errDistrict').text();
            return true;
        }
        else {
            $('.errDistrict').text('Please Select District');
            return false;
        }
    });
    $('.txtCustomerCode').keyup(function (e) {
        var CustomerCode = $('.txtCustomerCode').val();
        if (CustomerCode != '') {
            $('.errCustCode').text();
            return true;
        }
        else {
            $('.errCustCode').text('Please enter Customer Code');
            return false;
        }
    });
    $('.txtCustomerName').keyup(function (e) {
        var CustomerName = $('.txtCustomerName').val();
        if (CustomerName != '') {
            $('.errCustName').text();
            return true;
        }
        else {
            $('.errCustName').text('Please enter Name');
            return false;
        }
    });
    $('.txtMobileNumber').keyup(function (e) {
        var CustomerPhone = $('.txtMobileNumber').val();
        if (CustomerPhone != '') {
            $('.errCustMob').text();
            return true;
        }
        else {
            $('.errCustMob').text('Please enter Mobile Number');
            return false;
        }
    });
    $('.txtCustomerEmail').keyup(function (e) {
        var CustomerEmail = $('.txtCustomerEmail').val();
        if (CustomerEmail != '') {
            $('.errCustEmail').text();
            return true;
        }
        else {
            $('.errCustEmail').text('Please enter Email');
            return false;
        }
    });
    $('.txtCustCity').keyup(function (e) {
        var CustomerCity = $('.txtCustCity').val();
        if (CustomerCity != '') {
            $('.errCustCity').text();
            return true;
        }
        else {
            $('.errCustCity').text('Please enter City');
            return false;
        }
    });

    $('.txtCustPin').keyup(function (e) {
        var CustomerEmail = $('.txtCustPin').val();
        if (CustomerEmail != '') {
            $('.errCustPin').text();
            return true;
        }
        else {
            $('.errCustPin').text('Please enter Pin');
            return false;
        }
    });

    $('#txtadd').keyup(function (e) {
        var CustomerAddress = $('#txtadd').val();
        if (CustomerAddress != '') {
            $('.errCustAdd').text();
            return true;
        }
        else {
            $('.errCustAdd').text('Please enter Address');
            return false;
        }
    });


    function Validation() {
        var chk = 0;
        var CustomerCode = $("#txtcode").val();
        var CustomerName = $("#txtname").val();
        var CustomerPhone = $('.txtMobileNumber').val();
        var CustomerEmail = $('.txtCustomerEmail').val();
        var StateId = $('.ddlState option:selected').val();
        var CustomerCity = $('.txtCustCity').val();
        var CustomerEmail = $('.txtCustPin').val();
        var CustomerAddress = $('#txtadd').val();
        if (CustomerCode != '') {
            $('.errCustCode').text();
            chk = 1;
        }
        else {
            $('.errCustCode').text('Please enter Customer Code');
            chk = 0;
        }
        if (CustomerName != '') {
            $('.errCustName').text();

            chk = 1;
        }
        else {
            $('.errCustName').text('Please enter Name');
            chk = 0;
        }

        if (CustomerPhone != '') {
            $('.errCustMob').text();
            chk = 1;
        }
        else {
            $('.errCustMob').text('Please enter Mobile Number');
            chk = 0;
        }

        if (CustomerEmail != '') {
            $('.errCustEmail').text();
            chk = 1;
        }
        else {
            $('.errCustEmail').text('Please enter Email');
            chk = 0;
        }
        if (StateId != 0) {
            $('.errState').text();

        }
        else {
            $('.errState').text('Please Select State');
        }
        if (CustomerCity != '') {
            $('.errCustCity').text();
        }
        else {
            $('.errCustCity').text('Please enter City');
        }
        if (CustomerEmail != '') {
            $('.errCustPin').text();
        }
        else {
            $('.errCustPin').text('Please enter Pin');
        }
        if (CustomerAddress != '') {
            $('.errCustAdd').text();
        }
        else {
            $('.errCustAdd').text('Please enter Address');
            return;
        }

        if (chk == 1) {
            return true
        }
        else {
            return false;
        }


    }

   
    $(document).ready(function () {
        $("#StateId").change(function () {
            var id = $(this).val();
            $("#distid").empty();
            $.getJSON("/Home/District_Bind", { stateid: id }, function (data) {
                data = JSON.parse(data);
                var v = "<option>Select One</option>";
                $.each(data, function (i, v1) {
                    v += "<option value=" + v1.Value + ">" + v1.Text + "</option>";
                });
                $("#distid").html(v);
            });
        });
    });

    $(".btnSaveUpdate").click(function () {
        var chkValidation = Validation();
        if (chkValidation == true) {

            var CustRecord = {
                customerId: $("#txtid").val(), customerCode: $("#txtcode").val(), customerName: $("#txtname").val(), customerPhone: $("#txtmobile").val(), customerEmail: $("#txtemail").val(), stateId: $("#StateId").val(), districtId: $("#distid").val(), city: $("#txtcity").val(), pincode: $("#txtpincode").val(),
                customerGender: $(".s_type:checked").val(), customerAddress: $("#txtadd").val()
            };

            $.post("/Home/Create", CustRecord, function () {

                if (CustRecord != null & CustRecord.customerId == 0) {
                    alert("Data Inserted")
                    location.reload();
                }
                else {
                    alert("Data Updated")
                    window.location.replace("Show")
                }
            });

        }
        else {
            alert("Please Check your Data.");
        }
    });
    //$.getJSON("/Home/Edit", function (data) {
    //    var prod = JSON.parse(data);
    //    console.log(prod);
    //    alert(prod);
    //    $("#txtid").val(prod.CustomerId);
    //    $("#txtcode").val(prod.CustomerCode);
    //    $("#txtname").val(prod.CustomerName);
    //    $("#txtmobile").val(prod.CustomerPhone);
    //    $("#txtemail").val(prod.CustomerEmail);
    //    $("#StateId").val(prod.StateId);
    //    $("#distid").empty();
    //    $.getJSON("Home/District_Bind", { stateid: prod.StateId }, function (data) {
    //        data = JSON.parse(data);
    //        $.each(data, function (i, Dist) {
    //            $("#distid").append(
    //                `<option value=` + Dist.Value + `>` + Dist.Text + `</option>`
    //            );
    //            $("#distid").val(prod.DistrictId);
    //        });
    //    });
    //    $("#txtcity").val(prod.City);
    //    $("#txtpincode").val(prod.Pincode);

    //    $('input:radio').each(function () {
    //        if ($(this).val() == prod.CustomerGender)
    //            $(this).attr('checked', 'checked');
    //    });
    //    $("#txtadd").val(prod.CustomerAddress);
    //});
</script>