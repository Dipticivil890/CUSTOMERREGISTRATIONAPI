
@{
    ViewData["Title"] = "Show";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div class="container">
    <div class="form-group">
    </div>
    <table class="table table-striped table-class" id="table_school">
        <thead>
            <tr>
                <th>
                    Customer Id
                </th>
                <th>
                    Customer Code
                </th>
                <th>
                    Name
                </th>
                <th>
                    Mobile Number
                </th>
                <th>
                    Email
                </th>
                <th>
                    State
                </th>
                <th>
                    District
                </th>
                <th>
                    City
                </th>
                <th>
                    Pincode
                </th>
                <th>
                    Gender
                </th>
                <th>
                    Address
                </th>
                <th>
                    Action
                </th>
            </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
    <hr />
    <div id="nav"></div>
</div>
<div class="modal fade" id="SubmitModal" tabindex="1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5>Customer Details</h5>
            </div>
            <div class="modal-body">
                <h6 class="modalMsg"></h6>
                <h6 class="modalMsg1"></h6>
            </div>
            <div class="modal-footer">
                <input type="submit" class="btn btn-info btn-sm submitConfirm hbtn" value="Yes" style="display:none" />
                <input type="text" hidden id="cid" />
                <button type="button" class="btn btn-danger btn-sm No hbtn" data-dismiss="modal" aria-label="Close">No</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="SuccessModal" tabindex="1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="resultMsg" style="color:blue"></h5>
            </div>
            <div class="modal-body">
                <h5 class="msgsuccess"></h5>
            </div>
            <div class="modal-footer">
                <a class="btn btn-danger btnok" asp-controller="Home" asp-action="Show">Close</a>
            </div>
        </div>
    </div>
</div>



@section Scripts {
 
    <script type="text/javascript">
        $(document).ready(function () {
            GetCust();
        });
        function GetCust() {
            $.ajax({
                url: '/Home/GetCustomers',
                dataType: "JSON",
                method: 'Post',
                success: function (data) {
                    //debugger
                    $('#table_school tbody tr').empty();
                    data = JSON.parse(data);
                    var rows = '';
                    $.each(data, function (key, cust) {
                        rows += '<tr>';
                        rows += '<td>' + cust.customerId + '</td>';
                        rows += '<td>' + cust.customerCode + '</td>';
                        rows += '<td>' + cust.customerName + '</td>';
                        rows += '<td>' + cust.customerPhone + '</td>';
                        rows += '<td>' + cust.customerEmail + '</td>';
                        rows += '<td>' + cust.stateName + '</td>';
                        rows += '<td>' + cust.districtName + '</td>';
                        rows += '<td>' + cust.city + '</td>';
                        rows += '<td>' + cust.pincode + '</td>';
                        rows += '<td>' + cust.customerGender + '</td>';
                        rows += '<td>' + cust.customerAddress + '</td>';
                        rows += '<td><a href="Registration?Id=' + cust.customerId + '">Edit</a> | <a href = "javascript:void(0);" onClick = "DeleteCustomer(' + cust.customerId + ');">Delete</a></td>';
                        rows += '</tr>';
                    });
                    $('#table_school tbody').html(rows);
                    $('#table_school').DataTable();
                    //$('#table_school').after('<div id="nav"></div>');
                    //var rowsShown = 10;
                    //var rowsTotal = $('#table_school tbody tr').length;
                    //var numPages = rowsTotal / rowsShown;
                    //for (i = 0; i < numPages; i++) {
                    //    var pageNum = i + 1;
                    //    $('#nav').append('<a href="#" rel="' + i + '">' + pageNum + '</a> ');
                    //}
                    //$('#table_school tbody tr').hide();
                    //$('#table_school tbody tr').slice(0, rowsShown).show();
                    //$('#nav a:first').addClass('active');
                    //$('#nav a').bind('click', function () {
                    //    $('#nav a').removeClass('active');
                    //    $(this).addClass('active');
                    //    var currPage = $(this).attr('rel');
                    //    var startItem = currPage * rowsShown;
                    //    var endItem = startItem + rowsShown;
                    //    $('#table_school tbody tr').css('opacity', '0.0').hide().slice(startItem, endItem).
                    //        css('display', 'table-row').animate({ opacity: 1 }, 300);
                    //});
                },
                error: function (error) {
                    alert(error);
                }
            });
        }

        function DeleteCustomer(customerId) {
            $('#cid').val(customerId);
            $('.modalMsg').text('Are you sure to Delete the details ?');
            $('.submitConfirm').css('display', 'block');
            $('#SubmitModal').modal("show");
        }

        $(".submitConfirm").click(function () {
            var cid = $('#cid').val();
            $.post("/Home/Delete", { id: cid }, function (data) {
                data = JSON.parse(data);
                if (data == 1) {
                    $('.modalMsg').text('');
                    $('#SubmitModal').modal("hide");
                    $('.msgsuccess').text('Data Deleted successfully...!!!');
                    $("#SuccessModal").modal("show");
                }
                else {
                    alert("Data not Deleted");
                }
            });
        });
    </script>
}


